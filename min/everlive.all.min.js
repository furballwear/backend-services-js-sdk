/*!
  * Reqwest! A general purpose XHR connection manager
  * (c) Dustin Diaz 2013
  * https://github.com/ded/reqwest
  * license MIT
  */
!function(e,t,n){typeof module!="undefined"&&module.exports?module.exports=n():typeof define=="function"&&define.amd?define(n):t[e]=n()}("reqwest",this,function(){function handleReadyState(e,t,n){return function(){if(e._aborted)return n(e.request);e.request&&e.request[readyState]==4&&(e.request.onreadystatechange=noop,twoHundo.test(e.request.status)?t(e.request):n(e.request))}}function setHeaders(e,t){var n=t.headers||{},r;n.Accept=n.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"],!t.crossOrigin&&!n[requestedWith]&&(n[requestedWith]=defaultHeaders.requestedWith),n[contentType]||(n[contentType]=t.contentType||defaultHeaders.contentType);for(r in n)n.hasOwnProperty(r)&&e.setRequestHeader(r,n[r])}function setCredentials(e,t){typeof t.withCredentials!="undefined"&&typeof e.withCredentials!="undefined"&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var i=uniqid++,s=e.jsonpCallback||"callback",o=e.jsonpCallbackName||reqwest.getcallbackPrefix(i),u=new RegExp("((^|\\?|&)"+s+")=([^&]+)"),a=r.match(u),f=doc.createElement("script"),l=0,c=navigator.userAgent.indexOf("MSIE 10.0")!==-1;return a?a[3]==="?"?r=r.replace(u,"$1="+o):o=a[3]:r=urlappend(r,s+"="+o),win[o]=generalCallback,f.type="text/javascript",f.src=r,f.async=!0,typeof f.onreadystatechange!="undefined"&&!c&&(f.event="onclick",f.htmlFor=f.id="_reqwest_"+i),f.onload=f.onreadystatechange=function(){if(f[readyState]&&f[readyState]!=="complete"&&f[readyState]!=="loaded"||l)return!1;f.onload=f.onreadystatechange=null,f.onclick&&f.onclick(),e.success&&e.success(lastValue),lastValue=undefined,head.removeChild(f),l=1},head.appendChild(f),{abort:function(){f.onload=f.onreadystatechange=null,e.error&&e.error({},"Request is aborted: timeout",{}),lastValue=undefined,head.removeChild(f),l=1}}}function getRequest(e,t){var n=this.o,r=(n.method||"GET").toUpperCase(),i=typeof n=="string"?n:n.url,s=n.processData!==!1&&n.data&&typeof n.data!="string"?reqwest.toQueryString(n.data):n.data||null,o;return(n.type=="jsonp"||r=="GET")&&s&&(i=urlappend(i,s),s=null),n.type=="jsonp"?handleJsonp(n,e,t,i):(o=xhr(),o.open(r,i,!0),setHeaders(o,n),setCredentials(o,n),o.onreadystatechange=handleReadyState(this,e,t),n.before&&n.before(o),o.send(s),o)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){var t=e.match(/\.(json|jsonp|html|xml)(\?|$)/);return t?t[1]:"js"}function init(o,fn){function complete(e){o.timeout&&clearTimeout(self.timeout),self.timeout=null;while(self._completeHandlers.length>0)self._completeHandlers.shift()(e)}function success(resp){var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=resp.responseText=filteredResponse;if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp);while(self._fulfillmentHandlers.length>0)self._fulfillmentHandlers.shift()(resp);complete(resp)}function error(e,t,n){self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;while(self._errorHandlers.length>0)self._errorHandlers.shift()(e,t,n);complete(e)}this.url=typeof o=="string"?o:o.url,this.timeout=null,this._fulfilled=!1,this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this,type=o.type||setType(this.url);fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&this._fulfillmentHandlers.push(function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n=e.name,r=e.tagName.toLowerCase(),i=function(e){e&&!e.disabled&&t(n,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))},s,o,u,a;if(e.disabled||!n)return;switch(r){case"input":/reset|button|image|file/i.test(e.type)||(s=/checkbox/i.test(e.type),o=/radio/i.test(e.type),u=e.value,(!s&&!o||e.checked)&&t(n,normalize(s&&u===""?"on":u)));break;case"textarea":t(n,normalize(e.value));break;case"select":if(e.type.toLowerCase()==="select-one")i(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(a=0;e.length&&a<e.length;a++)e.options[a].selected&&i(e.options[a])}}function eachFormElement(){var e=this,t,n,r=function(t,n){var r,i,s;for(r=0;r<n.length;r++){s=t[byTag](n[r]);for(i=0;i<s.length;i++)serial(s[i],e)}};for(n=0;n<arguments.length;n++)t=arguments[n],/input|select|textarea/i.test(t.tagName)&&serial(t,e),r(t,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +(new Date),lastValue,xmlHttpRequest="XMLHttpRequest",noop=function(){},isArray=typeof Array.isArray=="function"?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=win[xmlHttpRequest]?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return this._fulfilled?e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(arguments.length===0)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),e=="map"?t=serializeHash:e=="array"?t=reqwest.serializeArray:t=serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e){var t="",n,r=encodeURIComponent,i=function(e,n){t+=r(e)+"="+r(n)+"&"},s,o;if(isArray(e))for(n=0;e&&n<e.length;n++)i(e[n].name,e[n].value);else for(s in e){if(!Object.hasOwnProperty.call(e,s))continue;o=e[s];if(isArray(o))for(n=0;n<o.length;n++)i(s,o[n]);else i(s,e[s])}return t.replace(/&$/,"").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest});// RSVP.js provides simple tools for organizing asynchronous code.
// https://github.com/tildeio/rsvp.js
// Copyright (c) 2013 Yehuda Katz, Tom Dale, and contributors
(function(){var e,t;(function(){var r={},n={};e=function(e,t,n){r[e]={deps:t,callback:n}};t=function(e){if(n[e]){return n[e]}n[e]={};var i=r[e],o=i.deps,s=i.callback,f=[],c;for(var u=0,a=o.length;u<a;u++){if(o[u]==="exports"){f.push(c={})}else{f.push(t(o[u]))}}var l=s.apply(this,f);return n[e]=c||l}})();e("rsvp/all",["rsvp/defer","exports"],function(e,t){"use strict";var r=e.defer;function n(e){var t=[],n=r(),i=e.length;if(i===0){n.resolve([])}var o=function(e){return function(t){s(e,t)}};var s=function(e,r){t[e]=r;if(--i===0){n.resolve(t)}};var f=function(e){n.reject(e)};for(var c=0;c<e.length;c++){if(e[c]&&typeof e[c].then==="function"){e[c].then(o(c),f)}else{s(c,e[c])}}return n.promise}t.all=n});e("rsvp/async",["exports"],function(e){"use strict";var t=typeof window!=="undefined"?window:{};var r=t.MutationObserver||t.WebKitMutationObserver;var n;if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){n=function(e,t){process.nextTick(function(){e.call(t)})}}else if(r){var i=[];var o=new r(function(){var e=i.slice();i=[];e.forEach(function(e){var t=e[0],r=e[1];t.call(r)})});var s=document.createElement("div");o.observe(s,{attributes:true});window.addEventListener("unload",function(){o.disconnect();o=null});n=function(e,t){i.push([e,t]);s.setAttribute("drainQueue","drainQueue")}}else{n=function(e,t){setTimeout(function(){e.call(t)},1)}}e.async=n});e("rsvp/config",["rsvp/async","exports"],function(e,t){"use strict";var r=e.async;var n={};n.async=r;t.config=n});e("rsvp/defer",["rsvp/promise","exports"],function(e,t){"use strict";var r=e.Promise;function n(){var e={};var t=new r(function(t,r){e.resolve=t;e.reject=r});e.promise=t;return e}t.defer=n});e("rsvp/events",["exports"],function(e){"use strict";var t=function(e,t){this.type=e;for(var r in t){if(!t.hasOwnProperty(r)){continue}this[r]=t[r]}};var r=function(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r][0]===t){return r}}return-1};var n=function(e){var t=e._promiseCallbacks;if(!t){t=e._promiseCallbacks={}}return t};var i={mixin:function(e){e.on=this.on;e.off=this.off;e.trigger=this.trigger;return e},on:function(e,t,i){var o=n(this),s,f;e=e.split(/\s+/);i=i||this;while(f=e.shift()){s=o[f];if(!s){s=o[f]=[]}if(r(s,t)===-1){s.push([t,i])}}},off:function(e,t){var i=n(this),o,s,f;e=e.split(/\s+/);while(s=e.shift()){if(!t){i[s]=[];continue}o=i[s];f=r(o,t);if(f!==-1){o.splice(f,1)}}},trigger:function(e,r){var i=n(this),o,s,f,c,u;if(o=i[e]){for(var a=0;a<o.length;a++){s=o[a];f=s[0];c=s[1];if(typeof r!=="object"){r={detail:r}}u=new t(e,r);f.call(c,u)}}}};e.EventTarget=i});e("rsvp/hash",["rsvp/defer","exports"],function(e,t){"use strict";var r=e.defer;function n(e){var t=0;for(var r in e){t++}return t}function i(e){var t={},i=r(),o=n(e);if(o===0){i.resolve({})}var s=function(e){return function(t){f(e,t)}};var f=function(e,r){t[e]=r;if(--o===0){i.resolve(t)}};var c=function(e){i.reject(e)};for(var u in e){if(e[u]&&typeof e[u].then==="function"){e[u].then(s(u),c)}else{f(u,e[u])}}return i.promise}t.hash=i});e("rsvp/node",["rsvp/promise","rsvp/all","exports"],function(e,t,r){"use strict";var n=e.Promise;var i=t.all;function o(e,t){return function(r,n){if(r){t(r)}else if(arguments.length>2){e(Array.prototype.slice.call(arguments,1))}else{e(n)}}}function s(e){return function(){var t=Array.prototype.slice.call(arguments),r,s;var f=new n(function(e,t){r=e;s=t});i(t).then(function(t){t.push(o(r,s));try{e.apply(this,t)}catch(n){s(n)}});return f}}r.denodeify=s});e("rsvp/promise",["rsvp/config","rsvp/events","exports"],function(e,t,r){"use strict";var n=e.config;var i=t.EventTarget;function o(e){return s(e)||typeof e==="object"&&e!==null}function s(e){return typeof e==="function"}var f=function(e){var t=this,r=false;if(typeof e!=="function"){throw new TypeError("You must pass a resolver function as the sole argument to the promise constructor")}if(!(t instanceof f)){return new f(e)}var n=function(e){if(r){return}r=true;u(t,e)};var i=function(e){if(r){return}r=true;l(t,e)};this.on("promise:resolved",function(e){this.trigger("success",{detail:e.detail})},this);this.on("promise:failed",function(e){this.trigger("error",{detail:e.detail})},this);e(n,i)};var c=function(e,t,r,n){var i=s(r),f,c,a,v;if(i){try{f=r(n.detail);a=true}catch(p){v=true;c=p}}else{f=n.detail;a=true}if(o(f)&&s(f.then)){f.then(function(e){u(t,e)},function(e){l(t,e)})}else if(i&&a){u(t,f)}else if(v){l(t,c)}else if(e==="resolve"){u(t,f)}else if(e==="reject"){l(t,f)}};f.prototype={constructor:f,then:function(e,t){var r=new f(function(){});if(this.isFulfilled){n.async(function(){c("resolve",r,e,{detail:this.fulfillmentValue})},this)}if(this.isRejected){n.async(function(){c("reject",r,t,{detail:this.rejectedReason})},this)}this.on("promise:resolved",function(t){c("resolve",r,e,t)});this.on("promise:failed",function(e){c("reject",r,t,e)});return r}};i.mixin(f.prototype);function u(e,t){if(e===t){a(e,t)}else if(o(t)&&s(t.then)){t.then(function(r){if(t!==r){u(e,r)}else{a(e,r)}},function(t){l(e,t)})}else{a(e,t)}}function a(e,t){n.async(function(){e.trigger("promise:resolved",{detail:t});e.isFulfilled=true;e.fulfillmentValue=t})}function l(e,t){n.async(function(){e.trigger("promise:failed",{detail:t});e.isRejected=true;e.rejectedReason=t})}r.Promise=f});e("rsvp/resolve",["rsvp/promise","exports"],function(e,t){"use strict";var r=e.Promise;function n(e){return typeof e==="function"||typeof e==="object"&&e!==null}function i(e){var t=new r(function(t,r){var i;try{if(n(e)){i=e.then;if(typeof i==="function"){i.call(e,t,r)}else{t(e)}}else{t(e)}}catch(o){r(o)}});return t}t.resolve=i});e("rsvp",["rsvp/events","rsvp/promise","rsvp/node","rsvp/all","rsvp/hash","rsvp/defer","rsvp/config","rsvp/resolve","exports"],function(e,t,r,n,i,o,s,f,c){"use strict";var u=e.EventTarget;var a=t.Promise;var l=r.denodeify;var v=n.all;var p=i.hash;var h=o.defer;var d=s.config;var y=f.resolve;function g(e,t){d[e]=t}c.Promise=a;c.EventTarget=u;c.all=v;c.hash=p;c.defer=h;c.denodeify=l;c.configure=g;c.resolve=y});window.RSVP=t("rsvp")})();
//     Underscore.js 1.4.4
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.
(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?(this._wrapped=n,void 0):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(w.has(n,a)&&t.call(e,n[a],a,n)===r)return};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h)return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(O);return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v)return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(O);return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};w.contains=w.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:E(n,function(n){return n===t})},w.invoke=function(n,t){var r=o.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length)return Math.max.apply(Math,n);if(!t&&w.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length)return Math.min.apply(Math,n);if(!t&&w.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;e.computed>a&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){r=null==r?w.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;u>r.call(e,n[o])?i=o+1:a=o}return i},w.toArray=function(n){return n?w.isArray(n)?o.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},w.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,o.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(c.apply(e,arguments))},w.intersection=function(n){var t=o.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=c.apply(e,o.call(arguments,1));return w.filter(n,function(n){return!w.contains(t,n)})},w.zip=function(){for(var n=o.call(arguments),t=w.max(w.pluck(n,"length")),r=Array(t),e=0;t>e;e++)r[e]=w.pluck(n,""+e);return r},w.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},w.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=w.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},w.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},w.range=function(n,t,r){1>=arguments.length&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=Array(e);e>u;)i[u++]=n,n+=r;return i},w.bind=function(n,t){if(n.bind===j&&j)return j.apply(n,o.call(arguments,1));var r=o.call(arguments,2);return function(){return n.apply(t,r.concat(o.call(arguments)))}},w.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},w.bindAll=function(n){var t=o.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(o.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,o=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var c=new Date,l=t-(c-a);return r=this,e=arguments,0>=l?(clearTimeout(u),u=null,a=c,i=n.apply(r,e)):u||(u=setTimeout(o,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,o=function(){e=null,r||(u=n.apply(i,a))},c=r&&!e;return clearTimeout(e),e=setTimeout(o,t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},w.after=function(n,t){return 0>=n?t():function(){return 1>--n?t.apply(this,arguments):void 0}},w.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)w.has(n,r)&&(t[t.length]=r);return t},w.values=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push(n[r]);return t},w.pairs=function(n){var t=[];for(var r in n)w.has(n,r)&&t.push([r,n[r]]);return t},w.invert=function(n){var t={};for(var r in n)w.has(n,r)&&(t[n[r]]=r);return t},w.functions=w.methods=function(n){var t=[];for(var r in n)w.isFunction(n[r])&&t.push(r);return t.sort()},w.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},w.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)w.contains(r,u)||(t[u]=n[u]);return t},w.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)null==n[r]&&(n[r]=t[r])}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var I=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==t+"";case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;r.push(n),e.push(t);var a=0,o=!0;if("[object Array]"==u){if(a=n.length,o=a==t.length)for(;a--&&(o=I(n[a],t[a],r,e)););}else{var c=n.constructor,f=t.constructor;if(c!==f&&!(w.isFunction(c)&&c instanceof c&&w.isFunction(f)&&f instanceof f))return!1;for(var s in n)if(w.has(n,s)&&(a++,!(o=w.has(t,s)&&I(n[s],t[s],r,e))))break;if(o){for(s in t)if(w.has(t,s)&&!a--)break;o=!a}}return r.pop(),e.pop(),o};w.isEqual=function(n,t){return I(n,t,[],[])},w.isEmpty=function(n){if(null==n)return!0;if(w.isArray(n)||w.isString(n))return 0===n.length;for(var t in n)if(w.has(n,t))return!1;return!0},w.isElement=function(n){return!(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return!(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return n===void 0},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;n>u;u++)e[u]=t.call(r,u);return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=w.invert(M.escape);var S={escape:RegExp("["+w.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+w.keys(M.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(S[n],function(t){return M[n][t]})}}),w.result=function(n,t){if(null==n)return null;var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,w);var c=function(n){return e.call(this,n,w)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);/*! jsTimezoneDetect - v1.0.5 - 2013-04-01 */
(function(e){var t=function(){"use strict";var e="s",n=2011,r=function(e){var t=-e.getTimezoneOffset();return t!==null?t:0},i=function(e,t,n){var r=new Date;return e!==undefined&&r.setFullYear(e),r.setDate(n),r.setMonth(t),r},s=function(e){return r(i(e,0,2))},o=function(e){return r(i(e,5,2))},u=function(e){var t=e.getMonth()>7?o(e.getFullYear()):s(e.getFullYear()),n=r(e);return t-n!==0},a=function(){var t=s(n),r=o(n),i=t-r;return i<0?t+",1":i>0?r+",1,"+e:t+",0"},f=function(){var e=a();return new t.TimeZone(t.olson.timezones[e])},l=function(e){var t=new Date(2010,6,15,1,0,0,0),n={"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Asia/Beirut":new Date(2011,2,27,1,0,0,0),"Europe/Helsinki":new Date(2011,2,27,4,0,0,0),"Europe/Istanbul":new Date(2011,2,28,5,0,0,0),"Asia/Damascus":new Date(2011,3,1,2,0,0,0),"Asia/Jerusalem":new Date(2011,3,1,6,0,0,0),"Asia/Gaza":new Date(2009,2,28,0,30,0,0),"Africa/Cairo":new Date(2009,3,25,0,30,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"Pacific/Fiji":new Date(2010,10,29,23,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Kamchatka":t,"Europe/Minsk":t,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)};return n[e]};return{determine:f,date_is_dst:u,dst_start_for:l}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Beirut","Europe/Helsinki","Europe/Istanbul","Asia/Damascus","Asia/Jerusalem","Asia/Gaza"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka"],"Pacific/Tongatapu":["Pacific/Apia"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"],"Asia/Baghdad":["Europe/Minsk"]},r=e,i=function(){var e=n[r],i=e.length,s=0,o=e[0];for(;s<i;s+=1){o=e[s];if(t.date_is_dst(t.dst_start_for(o))){r=o;return}}},s=function(){return typeof n[r]!="undefined"};return s()&&i(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},typeof exports!="undefined"?exports.jstz=t:e.jstz=t})(this);/*!
The MIT License (MIT)

Copyright (c) 2013 Telerik AD

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.y distributed under the MIT license.
*/
/*!
 Everlive SDK
 Version 1.2.10
 */
(function(b,c){if(typeof define==="function"&&define.amd){define(["underscore","rsvp","reqwest","jstz"],function(i,h,f,g){return(b.Everlive=c(i,h,f,g))})}else{if(typeof(isNativeScriptApplication)!=="undefined"&&isNativeScriptApplication){var e={Promise:Promise};b.RSVP=e;var d=require("http");var a=function(g){var j={url:g.url,method:g.method,headers:g.headers||{}};if(g.data){j.content=g.data}j.headers.Accept="application/json";j.headers["Content-Type"]="application/json";var h=function(){};var i=g.success||h;var f=g.error||h;d.request(j).then(function(k){var l=k.content.toString();if(k.statusCode<400){i(l)}else{f({responseText:l})}},function(k){f({responseText:k})})};b.reqwest=a;module.exports=c(exports._,b.RSVP,b.reqwest,exports.jstz)}else{if(typeof exports==="object"){module.exports=c(require("underscore"),require("rsvp"))}else{b.Everlive=c(b._,b.RSVP,b.reqwest,b.jstz)}}}}(this,function(B,k,m,h){var q=Array.prototype.slice;var E="//api.everlive.com/v1/";var i="Id";function a(H,F,G){if(!G){G="The "+F+" is required"}if(typeof H==="undefined"||H===null){throw new c(G)}}function x(F){this.url=E;this.apiKey=null;this.masterKey=null;this.token=null;this.tokenType=null;this.scheme="http";this._emulatorMode=F.emulatorMode;this.parseOnlyCompleteDateTimeObjects=false;if(typeof F==="string"){this.apiKey=F}else{B.extend(this,F)}}var t=[];function s(G){var F=this;this.setup=new x(G);B.each(t,function(H){H.func.call(F,G)});if(s.$===null){s.$=F}}s.$=null;s.idField=i;s.initializations=t;s.init=function(F){s.$=null;return new s(F)};s.buildUrl=function(F){var G="";if(typeof F.scheme==="string"){G+=F.scheme+":"}G+=F.url;if(F.apiKey){G+=F.apiKey+"/"}return G};s.prototype.data=function(F){return new f(this.setup,F)};s.prototype.buildUrl=function(){return s.buildUrl(this.setup)};var r=function(G,H){var F=null;if(H&&H.authHeaders===false){return F}if(G.token){F=(G.tokenType||"bearer")+" "+G.token}else{if(G.masterKey){F="masterkey "+G.masterKey}}if(F){return{Authorization:F}}else{return null}};s.prototype.buildAuthHeader=function(){return r(this.setup)};(function(){var L={query:1,where:100,filter:101,and:110,or:111,not:112,equal:120,not_equal:121,lt:122,lte:123,gt:124,gte:125,isin:126,notin:127,all:128,size:129,regex:130,contains:131,startsWith:132,endsWith:133,nearShpere:140,withinBox:141,withinPolygon:142,withinShpere:143,select:200,exclude:201,order:300,order_desc:301,skip:400,take:401,expand:402};function H(M,N){this.operator=M;this.operands=N||[]}H.prototype={addOperand:function(M){this.operands.push(M)}};function G(Q,M,O,R,N,P){this.filter=Q;this.fields=M;this.sort=O;this.toskip=R;this.totake=N;this.expandExpression=P;this.expr=new H(L.query)}G.prototype={where:function(M){if(M){return this._simple(L.filter,[M])}else{return new K(this)}},select:function(){return this._simple(L.select,arguments)},order:function(M){return this._simple(L.order,[M])},orderDesc:function(M){return this._simple(L.order_desc,[M])},skip:function(M){return this._simple(L.skip,[M])},take:function(M){return this._simple(L.take,[M])},expand:function(M){return this._simple(L.expand,[M])},build:function(){return new J(this).build()},_simple:function(O,M){var N=q.call(M);this.expr.addOperand(new H(O,N));return this}};function K(O,N,M){this.parent=O;this.single=M;this.expr=new H(N||L.where);this.parent.expr.addOperand(this.expr)}K.prototype={and:function(){return new K(this,L.and)},or:function(){return new K(this,L.or)},not:function(){return new K(this,L.not,true)},_simple:function(M){var N=q.call(arguments,1);this.expr.addOperand(new H(M,N));return this._done()},eq:function(N,M){return this._simple(L.equal,N,M)},ne:function(N,M){return this._simple(L.not_equal,N,M)},gt:function(N,M){return this._simple(L.gt,N,M)},gte:function(N,M){return this._simple(L.gte,N,M)},lt:function(N,M){return this._simple(L.lt,N,M)},lte:function(N,M){return this._simple(L.lte,N,M)},isin:function(N,M){return this._simple(L.isin,N,M)},notin:function(N,M){return this._simple(L.notin,N,M)},all:function(N,M){return this._simple(L.all,N,M)},size:function(N,M){return this._simple(L.size,N,M)},regex:function(O,N,M){return this._simple(L.regex,O,N,M)},startsWith:function(O,N,M){return this._simple(L.startsWith,O,N,M)},endsWith:function(O,N,M){return this._simple(L.endsWith,O,N,M)},nearSphere:function(O,M,P,N){return this._simple(L.nearShpere,O,M,P,N)},withinBox:function(N,O,M){return this._simple(L.withinBox,N,O,M)},withinPolygon:function(N,M){return this._simple(L.withinPolygon,N,M)},withinCenterSphere:function(P,N,M,O){return this._simple(L.withinShpere,P,N,M,O)},done:function(){if(this.parent instanceof K){return this.parent._done()}else{return this.parent}},_done:function(){if(this.single){return this.parent}else{return this}}};K.prototype.equal=K.prototype.eq;K.prototype.notEqual=K.prototype.ne;K.prototype.greaterThan=K.prototype.gt;K.prototype.greaterThanEqual=K.prototype.gte;K.prototype.lessThan=K.prototype.lt;K.prototype.lessThanEqual=K.prototype.lte;function J(M){this.query=M;this.expr=M.expr}var F={radians:"$maxDistance",km:"$maxDistanceInKilometers",miles:"$maxDistanceInMiles"};var I={radians:"radius",km:"radiusInKilometers",miles:"radiusInMiles"};J.prototype={build:function(){var M=this.query;if(M.filter||M.fields||M.sort||M.toskip||M.totake||M.expandExpression){return{$where:M.filter||null,$select:M.fields||null,$sort:M.sort||null,$skip:M.toskip||null,$take:M.totake||null,$expand:M.expandExpression||null}}return{$where:this._buildWhere(),$select:this._buildSelect(),$sort:this._buildSort(),$skip:this._getSkip(),$take:this._getTake(),$expand:this._getExpand()}},_getSkip:function(){var M=B.find(this.expr.operands,function(P,N,O){return P.operator===L.skip});return M?M.operands[0]:null},_getTake:function(){var M=B.find(this.expr.operands,function(P,N,O){return P.operator===L.take});return M?M.operands[0]:null},_getExpand:function(){var M=B.find(this.expr.operands,function(P,N,O){return P.operator===L.expand});return M?M.operands[0]:null},_buildSelect:function(){var N=B.find(this.expr.operands,function(Q,O,P){return Q.operator===L.select});var M={};if(N){B.reduce(N.operands,function(O,P){O[P]=1;return O},M);return M}else{return null}},_buildSort:function(){var N=B.filter(this.expr.operands,function(Q,O,P){return Q.operator===L.order||Q.operator===L.order_desc});var M={};if(N.length>0){B.reduce(N,function(O,P){O[P.operands[0]]=P.operator===L.order?1:-1;return O},M);return M}else{return null}},_buildWhere:function(){var M=B.find(this.expr.operands,function(Q,O,P){return Q.operator===L.where});if(M){return this._build(new H(L.and,M.operands))}else{var N=B.find(this.expr.operands,function(Q,O,P){return Q.operator===L.filter});if(N){return N.operands[0]}return null}},_build:function(M){if(this._isSimple(M)){return this._simple(M)}else{if(this._isRegex(M)){return this._regex(M)}else{if(this._isGeo(M)){return this._geo(M)}else{if(this._isAnd(M)){return this._and(M)}else{if(this._isOr(M)){return this._or(M)}else{if(this._isNot(M)){return this._not(M)}}}}}}},_isSimple:function(M){return M.operator>=L.equal&&M.operator<=L.size},_simple:function(Q){var P={},M={};var O=Q.operands;var N=this._translateoperator(Q.operator);if(N){P[N]=O[1]}else{P=O[1]}M[O[0]]=P;return M},_isRegex:function(M){return M.operator>=L.regex&&M.operator<=L.endsWith},_regex:function(Q){var M={};var P=this._getRegex(Q);var N=this._getRegexValue(P);var O=Q.operands;M[O[0]]=N;return M},_getRegex:function(O){var N=O.operands[1];var M=O.operands[2]?O.operands[2]:"";switch(O.operator){case L.regex:return N instanceof RegExp?N:new RegExp(N,M);case L.startsWith:return new RegExp("^"+N,M);case L.endsWith:return new RegExp(N+"$",M);default:throw new c("Unknown operator type.")}},_getRegexValue:function(N){var M="";if(N.global){M+="g"}if(N.multiline){M+="m"}if(N.ignoreCase){M+="i"}return{$regex:N.source,$options:M}},_isGeo:function(M){return M.operator>=L.nearShpere&&M.operator<=L.withinShpere},_geo:function(O){var M={};var N=O.operands;M[N[0]]=this._getGeoTerm(O);return M},_getGeoTerm:function(M){switch(M.operator){case L.nearShpere:return this._getNearSphereTerm(M);case L.withinBox:return this._getWithinBox(M);case L.withinPolygon:return this._getWithinPolygon(M);case L.withinShpere:return this._getWithinCenterSphere(M);default:throw new c("Unknown operator type.")}},_getNearSphereTerm:function(S){var O=S.operands;var M=this._getGeoPoint(O[1]);var R=O[2];var Q=O[3];var N;var P={"$nearSphere":M};if(typeof R!=="undefined"){N=F[Q]||F.radians;P[N]=R}return P},_getWithinBox:function(P){var N=P.operands;var M=this._getGeoPoint(N[1]);var O=this._getGeoPoint(N[2]);return{"$within":{"$box":[M,O]}}},_getWithinPolygon:function(O){var M=O.operands;var N=this._getGeoPoints(M[1]);return{"$within":{"$polygon":N}}},_getWithinCenterSphere:function(S){var Q=S.operands;var N=this._getGeoPoint(Q[1]);var M=Q[2];var R=Q[3];var O=I[R]||I.radians;var P={center:N};P[O]=M;return{"$within":{"$centerSphere":P}}},_getGeoPoint:function(M){if(B.isArray(M)){return new n(M[0],M[1])}return M},_getGeoPoints:function(N){var M=this;return B.map(N,function(O){return M._getGeoPoint(O)})},_isAnd:function(M){return M.operator===L.and},_and:function(R){var Q,N,P,M={};var O=R.operands;for(Q=0,N=O.length;Q<N;Q++){P=this._build(O[Q]);M=this._andAppend(M,P)}return M},_andAppend:function(Q,N){var P,M,O,S,T;var R=B.keys(N);for(P=0,M=R.length;P<M;P++){O=R[P];S=Q[O];if(typeof S==="undefined"){Q[O]=N[O]}else{T=N[O];if(typeof S==="object"&&typeof T==="object"){S=B.extend(S,T)}else{S=T}Q[O]=S}}return Q},_isOr:function(M){return M.operator===L.or},_or:function(R){var Q,N,P,M=[];var O=R.operands;for(Q=0,N=O.length;Q<N;Q++){P=this._build(O[Q]);M.push(P)}return{$or:M}},_isNot:function(M){return M.operator===L.not},_not:function(M){return{$not:this._build(M.operands[0])}},_translateoperator:function(M){switch(M){case L.equal:return null;case L.not_equal:return"$ne";case L.gt:return"$gt";case L.lt:return"$lt";case L.gte:return"$gte";case L.lte:return"$lte";case L.isin:return"$in";case L.notin:return"$nin";case L.all:return"$all";case L.size:return"$size"}throw new c("Unknown operator type.")}};s.Query=G;s.QueryBuilder=J}());var w=(function(){var Q={filter:"X-Everlive-Filter",select:"X-Everlive-Fields",sort:"X-Everlive-Sort",skip:"X-Everlive-Skip",take:"X-Everlive-Take",expand:"X-Everlive-Expand"};var M=null;function G(S,T){a(S,"setup");a(T,"options");this.setup=S;this.method=null;this.endpoint=null;this.data=null;this.headers={};this.success=null;this.error=null;this.parse=G.parsers.simple;B.extend(this,T);this._init(T);M=this}G.prototype={send:function(){s.sendRequest(this)},buildAuthHeader:r,buildUrl:function O(S){return s.buildUrl(S)},buildQueryHeaders:function J(S){if(S){if(S instanceof s.Query){return G.prototype._buildQueryHeaders(S)}else{return G.prototype._buildFilterHeader(S)}}else{return{}}},_init:function(S){B.extend(this.headers,this.buildAuthHeader(this.setup,S),this.buildQueryHeaders(S.filter),S.headers)},_buildQueryHeaders:function(S){S=S.build();var T={};if(S.$where!==null){T[Q.filter]=JSON.stringify(S.$where)}if(S.$select!==null){T[Q.select]=JSON.stringify(S.$select)}if(S.$sort!==null){T[Q.sort]=JSON.stringify(S.$sort)}if(S.$skip!==null){T[Q.skip]=S.$skip}if(S.$take!==null){T[Q.take]=S.$take}if(S.$expand!==null){T[Q.expand]=JSON.stringify(S.$expand)}return T},_buildFilterHeader:function(S){var T={};T[Q.filter]=JSON.stringify(S);return T}};s.Request=G;s.prototype.request=function(S){return new G(this.setup,S)};function R(W){if(M&&M.setup&&M.setup.parseOnlyCompleteDateTimeObjects){if(/^\d{4}-\d{2}-\d{2}$/.test(W)){return null}if(/^(\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|((\+|-)(\d{2}):(\d{2})))?$/.test(W)){return null}}var V;if(V=W.match(/^(\d{4})(-(\d{2})(-(\d{2})(T(\d{2}):(\d{2})(:(\d{2})(\.(\d+))?)?(Z|((\+|-)(\d{2}):(\d{2}))))?))$/)){var T=V[12];if(T){if(T.length>3){T=Math.round(Number(T.substr(0,3)+"."+T.substr(3)))}else{if(T.length<3){T+=T.length===2?"0":"00"}}}var U=new Date(Date.UTC(Number(V[1]),(Number(V[3])-1)||0,Number(V[5])||0,Number(V[7])||0,Number(V[8])||0,Number(V[10])||0,Number(T)||0));if(V[13]&&V[13]!=="Z"){var X=Number(V[16])||0,S=Number(V[17])||0;X*=3600000;S*=60000;var Y=X+S;if(V[15]==="+"){Y=-Y}U=new Date(U.valueOf()+Y)}return U}else{return null}}function N(T,U){if(typeof U==="string"){var S=R(U);if(S){U=S}}return U}function K(W,T){var S,U,V;for(S in W){if(W.hasOwnProperty(S)){U=W[S];V=T(S,U);W[S]=V;if(U===V&&typeof U==="object"){K(U,T)}}}}function F(S){K(S,N)}s._traverseAndRevive=F;function H(S){if(typeof S==="string"&&S.length>0){S=JSON.parse(S,N)}else{if(typeof S==="object"){F(S)}}if(S){return{result:S.Result,count:S.Count}}else{return S}}function I(S){if(typeof S==="string"&&S.length>0){try{S=JSON.parse(S);return{message:S.message,code:S.errorCode}}catch(T){return S}}else{return S}}function P(S){if(typeof S==="string"&&S.length>0){S=JSON.parse(S,N)}else{if(typeof S==="object"){F(S)}}if(S){return{result:S.Result}}else{return S}}function L(S){if(typeof S==="string"&&S.length>0){S=JSON.parse(S,N)}else{if(typeof S==="object"){F(S)}}if(S){return{result:S.Result,ModifiedAt:S.ModifiedAt}}else{return S}}G.parsers={simple:{result:H,error:I},single:{result:P,error:I},update:{result:L,error:I}};s.disableRequestCache=function(S,V){if(V==="GET"){var T=(new Date()).getTime();var U=S.indexOf("?")>-1?"&":"?";S+=U+"_el="+T}return S};if(typeof s.sendRequest==="undefined"){s.sendRequest=function(T){var S=T.buildUrl(T.setup)+T.endpoint;S=s.disableRequestCache(S,T.method);var U=T.method==="GET"?T.data:JSON.stringify(T.data);m({url:S,method:T.method,data:U,headers:T.headers,type:"json",contentType:"application/json",crossOrigin:true,success:function(W,X,V){T.success.call(T,T.parse.result(W))},error:function(V,X,W){T.error.call(T,T.parse.error(V.responseText))}})}}return G}());s.getCallbacks=function(H,F){var G;if(typeof H!=="function"&&typeof F!=="function"){G=new k.Promise(function(J,I){H=function(K){J(K)};F=function(K){I(K)}})}return{promise:G,success:H,error:F}};function v(F,I,G){var H=s.getCallbacks(I,G);F(H.success,H.error);return H.promise}function A(F,G){return function(J,H){var I=J.result;if(B.isArray(F)||typeof F.length==="number"){B.each(F,function(L,K){B.extend(L,I[K])})}else{B.extend(F,I)}G(J,H)}}function l(F,G){return function(I){var H=I.ModifiedAt;F.ModifiedAt=H;G(I)}}function f(F,G){this.setup=F;this.collectionName=G;this.options=null}f.prototype={withHeaders:function(G){var F=this.options||{};F.headers=B.extend(F.headers||{},G);this.options=F;return this},expand:function(G){var F={"X-Everlive-Expand":JSON.stringify(G)};return this.withHeaders(F)},_createRequest:function(F){B.extend(F,this.options);this.options=null;return new w(this.setup,F)},get:function(H,I,G){var F=this;return v(function(L,J){var K=F._createRequest({method:"GET",endpoint:F.collectionName,filter:H,success:L,error:J});K.send()},I,G)},getById:function(I,H,G){var F=this;return v(function(L,J){var K=F._createRequest({method:"GET",endpoint:F.collectionName+"/"+I,parse:w.parsers.single,success:L,error:J});K.send()},H,G)},count:function(H,I,G){var F=this;return v(function(L,J){var K=F._createRequest({method:"GET",endpoint:F.collectionName+"/_count",filter:H,parse:w.parsers.single,success:L,error:J});K.send()},I,G)},create:function(H,I,G){var F=this;return v(function(L,J){var K=F._createRequest({method:"POST",endpoint:F.collectionName,data:H,parse:w.parsers.single,success:A(H,L),error:J});K.send()},I,G)},rawUpdate:function(H,I,J,G){var F=this;return v(function(O,L){var N=F.collectionName;var K=null;if(typeof I==="string"){N+="/"+I}else{if(typeof I==="object"){K=I}}var M=F._createRequest({method:"PUT",endpoint:N,data:H,filter:K,success:O,error:L});M.send()},J,G)},_update:function(H,J,L,I,K,G){var F=this;return v(function(R,M){var Q=F.collectionName;var O=R;if(L){Q+="/"+H[i];O=l(H,R)}var P={};P[I?"$replace":"$set"]=H;var N=F._createRequest({method:"PUT",endpoint:Q,parse:w.parsers.update,data:P,filter:J,success:O,error:M});N.send()},K,G)},updateSingle:function(G,H,F){return this._update(G,null,true,false,H,F)},update:function(G,H,I,F){return this._update(G,H,false,false,I,F)},_destroy:function(H,I,K,J,G){var F=this;return v(function(O,L){var N=F.collectionName;if(K){N+="/"+H[i]}var M=F._createRequest({method:"DELETE",endpoint:N,filter:I,success:O,error:L});M.send()},J,G)},destroySingle:function(G,H,F){return this._destroy(G,null,true,H,F)},destroy:function(G,H,F){return this._destroy(null,G,false,H,F)},setAcl:function(J,H,I,G){var F=this;return v(function(O,K){var N=F.collectionName;if(typeof H==="string"){N+="/"+H}else{if(typeof H==="object"){N+="/"+H[i]}}N+="/_acl";var P,M;if(J===null){P="DELETE"}else{P="PUT";M=J}var L=F._createRequest({method:P,endpoint:N,data:M,success:O,error:K});L.send()},I,G)},setOwner:function(F,I,J,H){var G=this;return v(function(N,K){var M=G.collectionName;if(typeof I==="string"){M+="/"+I}else{if(typeof I==="object"){M+="/"+I[i]}}M+="/_owner";var L=G._createRequest({method:"PUT",endpoint:M,data:{Owner:F},success:N,error:K});L.send()},J,H)},save:function(I,J,H){var G=this;var F=this.isNew(I);return v(function(N,K){function M(O){O.type=F?"create":"update";N(O)}function L(O){O.type=F?"create":"update";K(O)}if(F){return G.create(I,M,L)}else{return G.updateSingle(I,M,L)}},J,H)},isNew:function(F){return typeof F[i]==="undefined"}};s.Data=f;function n(F,G){this.longitude=F||0;this.latitude=G||0}s.GeoPoint=n;var g={unauthenticated:"unauthenticated",masterKey:"masterKey",invalidAuthentication:"invalidAuthentication",authenticated:"authenticated"};s.AuthStatus=g;function j(F,I,K,H){if(F.masterKey){return v(function(M,L){M({status:g.masterKey})},K,H)}if(!F.token){return v(function(M,L){M({status:g.unauthenticated})},K,H)}var G;if(K){G=function(L){if(L&&L.code===601){K({status:g.invalidAuthentication})}else{H(L)}}}var J=I(K,G);if(J){J=J.then(function(L){return{status:g.authenticated,user:L.result}},function(L){if(L&&L.code===601){return{status:g.invalidAuthentication}}else{throw L}})}return J}s.prototype.authInfo=function(G,F){return j(this.setup,B.bind(this.Users.getById,this.Users,"me"),G,F)};var d=function(H){H._loginSuccess=function(J){var I=J.result;this.setAuthorization(I.access_token,I.token_type)};H._logoutSuccess=function(){this.clearAuthorization()};H.register=function(N,L,K,M,J){a(N,"username");a(L,"password");var I={Username:N,Password:L};B.extend(I,K);return this.create(I,M,J)};H.login=function(M,K,L,J){var I=this;return v(function(P,N){var O=new w(I.setup,{method:"POST",endpoint:"oauth/token",data:{username:M,password:K,grant_type:"password"},authHeaders:false,parse:w.parsers.single,success:function(){I._loginSuccess.apply(I,arguments);P.apply(null,arguments)},error:N});O.send()},L,J)};H.currentUser=function(K,J){var I=this;return v(function(M,L){j(I.setup,B.bind(I.getById,I,"me")).then(function(N){if(typeof N.user!=="undefined"){M({result:N.user})}else{M({result:null})}},function(N){L(N)})},K,J)};H.changePassword=function(O,K,N,L,M,J){var I=this;return v(function(S,P){var R="Users/changepassword";if(L){R+="?keepTokens=true"}var Q=new w(I.setup,{method:"POST",endpoint:R,data:{Username:O,Password:K,NewPassword:N},authHeaders:false,parse:w.parsers.single,success:S,error:P});Q.send()},M,J)};H.logout=function(K,J){var I=this;return v(function(N,L){var M=new w(I.setup,{method:"GET",endpoint:"oauth/logout",success:function(){I._logoutSuccess.apply(I,arguments);N.apply(null,arguments)},error:function(O){if(O.code===301){I.clearAuthorization()}L.apply(null,arguments)}});M.send()},K,J)};H._loginWithProvider=function(K,M,L){var J={Identity:K};var I=this;return v(function(P,N){var O=new w(I.setup,{method:"POST",endpoint:"Users",data:J,authHeaders:false,parse:w.parsers.single,success:function(){I._loginSuccess.apply(I,arguments);P.apply(null,arguments)},error:N});O.send()},M,L)};H._linkWithProvider=function(J,L,M,K){var I=this;return v(function(P,N){var O=new w(I.setup,{method:"POST",endpoint:"Users/"+L+"/link",data:J,parse:w.parsers.single,success:P,error:N});O.send()},M,K)};H._unlinkFromProvider=function(M,L,N,K){var J={Provider:M};var I=this;return v(function(Q,O){var P=new w(I.setup,{method:"POST",endpoint:"Users/"+L+"/unlink",data:J,parse:w.parsers.single,success:Q,error:O});P.send()},N,K)};H.loginWithFacebook=function(K,L,J){var I={Provider:"Facebook",Token:K};return H._loginWithProvider(I,L,J)};H.linkWithFacebook=function(L,K,M,J){var I={Provider:"Facebook",Token:K};return H._linkWithProvider(I,L,M,J)};H.unlinkFromFacebook=function(J,K,I){return H._unlinkFromProvider("Facebook",J,K,I)};H.loginWithADFS=function(K,L,J){var I={Provider:"ADFS",Token:K};return H._loginWithProvider(I,L,J)};H.linkWithADFS=function(L,K,M,J){var I={Provider:"ADFS",Token:K};return H._linkWithProvider(I,L,M,J)};H.unlinkFromADFS=function(J,K,I){return H._unlinkFromProvider("ADFS",J,K,I)};H.loginWithLiveID=function(K,L,J){var I={Provider:"LiveID",Token:K};return H._loginWithProvider(I,L,J)};H.linkWithLiveID=function(L,K,M,J){var I={Provider:"LiveID",Token:K};return H._linkWithProvider(I,L,M,J)};H.unlinkFromLiveID=function(J,K,I){return H._unlinkFromProvider("LiveID",J,K,I)};H.loginWithGoogle=function(K,L,J){var I={Provider:"Google",Token:K};return H._loginWithProvider(I,L,J)};H.linkWithGoogle=function(L,K,M,J){var I={Provider:"Google",Token:K};return H._linkWithProvider(I,L,M,J)};H.unlinkFromGoogle=function(J,K,I){return H._unlinkFromProvider("Google",J,K,I)};H.loginWithTwitter=function(K,L,M,J){var I={Provider:"Twitter",Token:K,TokenSecret:L};return H._loginWithProvider(I,M,J)};H.linkWithTwitter=function(L,K,M,N,J){var I={Provider:"Twitter",Token:K,TokenSecret:M};return H._linkWithProvider(I,L,N,J)};H.unlinkFromTwitter=function(J,K,I){return H._unlinkFromProvider("Twitter",J,K,I)};H.setAuthorization=function G(I,J){this.setup.token=I;this.setup.tokenType=J};H.clearAuthorization=function F(){this.setAuthorization(null,null)}};var p=function(F){F.getUploadUrl=function(){return s.buildUrl(this.setup)+this.collectionName};F.getDownloadUrl=function(G){return s.buildUrl(this.setup)+this.collectionName+"/"+G+"/Download"};F._getUpdateUrl=function(G){return this.collectionName+"/"+G+"/Content"};F.getUpdateUrl=function(G){return s.buildUrl(this.setup)+this._getUpdateUrl(G)};F.updateContent=function(G,J,K,I){var H=this;return v(function(O,L){var N=H._getUpdateUrl(G);var M=H._createRequest({method:"PUT",endpoint:N,data:J,success:O,error:L});M.send()},K,I)};F.getDownloadUrlById=function(G,J,I){var H=this;return v(function(M,K){var L=H._createRequest({method:"GET",endpoint:H.collectionName+"/"+G,parse:w.parsers.single,success:function(N){M(N.result.Uri)},error:K});L.send()},J,I)}};var D={WindowsPhone:1,Windows:2,Android:3,iOS:4,OSX:5,Blackberry:6,Nokia:7,Unknown:100};s.PushCallbacks={};var o=function(F){this._el=F;this.notifications=F.data("Push/Notifications");this.devices=F.data("Push/Devices")};o.prototype={ensurePushIsAvailable:function(){var F=(typeof window!=="undefined"&&window.plugins&&window.plugins.pushNotification);if(!F){throw new c("The push notification plugin is not available. Ensure that the pushNotification plugin is included and use after `\deviceready` event has been fired.")}},currentDevice:function(F){this.ensurePushIsAvailable();if(arguments.length===0){F=this._el.setup._emulatorMode}if(!window.cordova){throw new c("Error: currentDevice() can only be called from within a hybrid mobile app, after 'deviceready' event has been fired.")}if(!this._currentDevice){this._currentDevice=new b(this)}this._currentDevice.emulatorMode=F;return this._currentDevice},register:function(K,M,I){this.ensurePushIsAvailable();var J=this.currentDevice();var H=this;K=K||{};if(K.android){K.android.senderID=K.android.projectNumber||K.android.senderID}var F=function(O,P){var N=new e(O);P(N)};var G=function(O,P){var N=C.fromEverliveError(O);P(N)};var L=function(N,Q,O){var P=true;if(K.iOS){P=K.iOS.clearBadge!==false}if(P){H.clearBadgeNumber().then(function(){F(N,Q)},function(R){G(R,O)})}else{F(N,Q)}};return v(function(O,N){J.enableNotifications(K,function(Q){var R=Q.token;var P=K.customParameters;J.getRegistration().then(function(){J.updateRegistration(P,function(){L(R,O,N)},function(S){G(S,N)})},function(S){if(S.code===801){J.register(P,function(){L(R,O,N)},N)}else{G(S,N)}})},function(Q){var P=C.fromPluginError(Q);N(P)})},M,I)},unregister:function(H,G){this.ensurePushIsAvailable();var F=this.currentDevice();return F.disableNotifications.apply(F,arguments)},updateRegistration:function(F,I,H){this.ensurePushIsAvailable();var G=this.currentDevice();return G.updateRegistration.apply(G,arguments)},setBadgeNumber:function(F,K,I){this.ensurePushIsAvailable();F=parseInt(F);if(isNaN(F)){return v(function(M,L){L(new c("The badge must have a numeric value"))},K,I)}var H={};var G=this.currentDevice();var J=G._getDeviceId();H.Id="HardwareId/"+encodeURIComponent(J);H.BadgeCounter=F;return v(function(M,L){G._pushHandler.devices.updateSingle(H).then(function(){if(window.plugins&&window.plugins.pushNotification){return window.plugins.pushNotification.setApplicationIconBadgeNumber(M,L,F)}else{return M()}},L)},K,I)},clearBadgeNumber:function(G,F){this.ensurePushIsAvailable();return this.setBadgeNumber(0,G,F)},getRegistration:function(H,G){this.ensurePushIsAvailable();var F=this.currentDevice();return F.getRegistration.apply(F,arguments)},send:function(G,H,F){this.ensurePushIsAvailable();return this.notifications.create.apply(this.notifications,arguments)},areNotificationsEnabled:function(G,I,H){this.ensurePushIsAvailable();G=G||{};var F=window.plugins.pushNotification;return v(function(K,J){F.areNotificationsEnabled(K,J,G)},I,H)}};var b=function(F){this._pushHandler=F;this._initSuccessCallback=null;this._initErrorCallback=null;this._globalFunctionSuffix=null;this.pushSettings=null;this.pushToken=null;this.isInitialized=false;this.isInitializing=false;this.emulatorMode=false};b.prototype={enableNotifications:function(F,H,G){this.pushSettings=this._cleanPlatformsPushSettings(F);return v(B.bind(this._initialize,this),H,G)},disableNotifications:function(H,G){var F=this;return this.unregister().then(function(){return v(function(M,K){if(F.emulatorMode){M()}else{var I=window.plugins.pushNotification;var L;var J=F._getPlatformType(device.platform);if(J===D.WindowsPhone){L={channelName:F.pushSettings.wp8.channelName}}I.unregister(function(){F.isInitialized=false;M()},K,L)}},H,G)},G)},getRegistration:function(H,F){var G=encodeURIComponent(this._getDeviceId());return this._pushHandler.devices.getById("HardwareId/"+G,H,F)},register:function(G,J,H){var F=this;var I={};if(G!==undefined){I.Parameters=G}return this._populateRegistrationObject(I).then(function(){return F._pushHandler.devices.create(I,J,H)},H)},unregister:function(H,F){var G=encodeURIComponent(device.uuid);return this._pushHandler.devices.destroySingle({Id:"HardwareId/"+G},H,F)},updateRegistration:function(G,J,H){var F=this;var I={};if(G!==undefined){I.Parameters=G}return this._populateRegistrationObject(I).then(function(){I.Id="HardwareId/"+encodeURIComponent(I.HardwareId);return F._pushHandler.devices.updateSingle(I,J,H)},H)},_initialize:function(Q,O){var S=this;if(this.isInitializing){O(new c("Push notifications are currently initializing."));return}if(!this.emulatorMode&&(!window.navigator||!window.navigator.globalization)){O(new c("The globalization plugin is not initialized."));return}if(!this.emulatorMode&&(!window.plugins||!window.plugins.pushNotification)){O(new c("The push notifications plugin is not initialized."));return}this._initSuccessCallback=Q;this._initErrorCallback=O;if(this.isInitialized){this._deviceRegistrationSuccess(this.pushToken);return}if(this.emulatorMode){setTimeout(function(){S._deviceRegistrationSuccess("fake_push_token")},1000);return}this.isInitializing=true;var R=this._globalFunctionSuffix;if(!R){R=Date.now().toString();this._globalFunctionSuffix=R}var G=window.plugins.pushNotification;var J=this._getPlatformType(device.platform);if(J===D.iOS){var L="apnCallback_"+R;s.PushCallbacks[L]=B.bind(this._onNotificationAPN,this);var N=this.pushSettings.iOS;this._validateIOSSettings(N);N.ecb="Everlive.PushCallbacks."+L;G.register(B.bind(this._successfulRegistrationAPN,this),B.bind(this._failedRegistrationAPN,this),N)}else{if(J===D.Android){var F="gcmCallback_"+R;s.PushCallbacks[F]=B.bind(this._onNotificationGCM,this);var I=this.pushSettings.android;this._validateAndroidSettings(I);I.ecb="Everlive.PushCallbacks."+F;G.register(B.bind(this._successSentRegistrationGCM,this),B.bind(this._errorSentRegistrationGCM,this),I)}else{if(J===D.WindowsPhone){var K="wp8Callback_"+R;var P="wp8RegistrationSuccessCallback_"+R;var H="wp8RegistrationErrorCallback_"+R;s.PushCallbacks[K]=B.bind(this._onNotificationWP8,this);s.PushCallbacks[P]=B.bind(this._deviceRegistrationSuccessWP,this);s.PushCallbacks[H]=B.bind(this._deviceRegistrationFailed,this);var M=this.pushSettings.wp8;this._validateWP8Settings(M);M.ecb="Everlive.PushCallbacks."+K;M.uccb="Everlive.PushCallbacks."+P;M.errcb="Everlive.PushCallbacks."+H;G.register(B.bind(this._successSentRegistrationWP8,this),B.bind(this._errorSentRegistrationWP8,this),M)}else{throw new c("The current platform is not supported: "+device.platform)}}}},_deviceRegistrationSuccessWP:function(F){this._deviceRegistrationSuccess(F.uri)},_validateAndroidSettings:function(F){if(!F.senderID){throw new c("Sender ID (project number) is not set in the android settings.")}},_validateWP8Settings:function(F){if(!F.channelName){throw new c("channelName is not set in the WP8 settings.")}},_validateIOSSettings:function(F){},_cleanPlatformsPushSettings:function(G){var I={};G=G||{};var F=function F(K,J,L){if(!G[J]){return}K[J]=K[J]||{};var N=G[J];var M=K[J];B.each(L,function(O){if(N.hasOwnProperty(O)){M[O]=N[O]}})};F(I,"iOS",["badge","sound","alert"]);F(I,"android",["senderID","projectNumber"]);F(I,"wp8",["channelName"]);var H=["notificationCallbackAndroid","notificationCallbackIOS","notificationCallbackWP8"];B.each(H,function(J){var K=G[J];if(K){if(typeof K!=="function"){throw new c('The "'+J+'" of the push settings should be a function')}I[J]=G[J]}});if(G.customParameters){I.customParameters=G.customParameters}return I},_populateRegistrationObject:function(H,I,G){var F=this;return v(function(K,J){if(!F.pushToken){throw new c("Push token is not available.")}F._getLocaleName(function(L){var R=F._getDeviceId();var P=device.model;var N=F._getPlatformType(device.platform);var O=h.determine().name();var M=F.pushToken;var S=L.value;var Q=device.version;H.HardwareId=R;H.HardwareModel=P;H.PlatformType=N;H.PlatformVersion=Q;H.TimeZone=O;H.PushToken=M;H.Locale=S;K()},J)},I,G)},_getLocaleName:function(G,F){if(this.emulatorMode){G({value:"en_US"})}else{navigator.globalization.getLocaleName(function(H){G(H)},F);navigator.globalization.getLocaleName(function(H){},F)}},_getDeviceId:function(){return device.uuid},_getPlatformType:function(G){var F=G.toLowerCase();switch(F){case"ios":case"iphone":case"ipad":return D.iOS;case"android":return D.Android;case"wince":return D.WindowsPhone;case"win32nt":return D.WindowsPhone;default:return D.Unknown}},_deviceRegistrationFailed:function(F){this.pushToken=null;this.isInitializing=false;this.isInitialized=false;if(this._initErrorCallback){this._initErrorCallback({error:F})}},_deviceRegistrationSuccess:function(F){this.pushToken=F;this.isInitializing=false;this.isInitialized=true;if(this._initSuccessCallback){this._initSuccessCallback({token:F})}},_successfulRegistrationAPN:function(F){this._deviceRegistrationSuccess(F)},_failedRegistrationAPN:function(F){this._deviceRegistrationFailed(F)},_successSentRegistrationGCM:function(F){},_successSentRegistrationWP8:function(F){},_errorSentRegistrationWP8:function(F){this._deviceRegistrationFailed(F)},_errorSentRegistrationGCM:function(F){this._deviceRegistrationFailed(F)},_onNotificationAPN:function(F){this._raiseNotificationEventIOS(F)},_onNotificationWP8:function(F){this._raiseNotificationEventWP8(F)},_onNotificationGCM:function y(F){switch(F.event){case"registered":if(F.regid.length>0){this._deviceRegistrationSuccess(F.regid)}break;case"message":this._raiseNotificationEventAndroid(F);break;case"error":if(!this.pushToken){this._deviceRegistrationFailed(F)}else{this._raiseNotificationEventAndroid(F)}break;default:this._raiseNotificationEventAndroid(F);break}},_raiseNotificationEventAndroid:function(F){if(this.pushSettings.notificationCallbackAndroid){this.pushSettings.notificationCallbackAndroid(F)}},_raiseNotificationEventIOS:function(F){if(this.pushSettings.notificationCallbackIOS){this.pushSettings.notificationCallbackIOS(F)}},_raiseNotificationEventWP8:function(F){if(this.pushSettings.notificationCallbackWP8){this.pushSettings.notificationCallbackWP8(F)}}};function c(){var F=Error.apply(this,arguments);F.name=this.name="EverliveError";this.message=F.message;Object.defineProperty(this,"stack",{get:function(){return F.stack}});return this}c.prototype=Object.create(Error.prototype);c.prototype.toJSON=function(){return{name:this.name,message:this.message,stack:this.stack}};var C=function(H,G,F){c.call(this,G);this.errorType=H;this.message=G;if(F!==undefined){this.additionalInformation=F}};C.prototype=Object.create(c.prototype);C.fromEverliveError=function(G){var F=new C(u.EverliveError,G.message,G);return F};C.fromPluginError=function(G){var H="A plugin error occurred";if(G){if(typeof G.error==="string"){H=G.error}else{if(typeof G.message==="string"){H=G.message}}}var F=new C(u.PluginError,H,G);return F};var u={EverliveError:1,PluginError:2};var e=function(F){this.token=F};var z=function(){this.Users=this.data("Users");d(this.Users);this.Files=this.data("Files");p(this.Files);this.push=new o(this)};t.push({name:"default",func:z});return s}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["Everlive"],function(c){b(c)})}else{b(a.Everlive)}}(this,function(n){var h=window.jQuery,j=window.kendo;if(h===undefined||j===undefined){return}var i=h.extend;i(true,j.data,{schemas:{everlive:{type:"json",data:function(o){if(typeof o.ModifiedAt!=="undefined"){return{ModifiedAt:o.ModifiedAt}}else{return o.Result||o}},total:"Count",model:{id:"Id"}}},transports:{everlive:{read:{dataType:"json",type:"GET",cache:false},update:{dataType:"json",contentType:"application/json",type:"PUT",cache:false},create:{dataType:"json",contentType:"application/json",type:"POST",cache:false},destroy:{dataType:"json",type:"DELETE",cache:false},parameterMap:function(p,o){if(o==="destroy"){return{}}if(o==="create"||o==="update"){return JSON.stringify(p)}if(o==="read"){return null}}}}});function l(s){var o={};if(s){if(s.skip){o.$skip=s.skip;delete s.skip}if(s.take){o.$take=s.take;delete s.take}if(s.sort){var r=s.sort;var p={};if(!h.isArray(r)){r=[r]}h.each(r,function(t,u){p[u.field]=u.dir==="asc"?1:-1});o.$sort=p;delete s.sort}if(s.filter){var q=new k().build(s.filter);o.$where=q;delete s.filter}}return o}var m=["startswith","startsWith","endswith","endsWith","contains"];function k(){}k.prototype={build:function(o){return this._build(o)},_build:function(o){if(this._isRaw(o)){return this._raw(o)}else{if(this._isSimple(o)){return this._simple(o)}else{if(this._isRegex(o)){return this._regex(o)}else{if(this._isAnd(o)){return this._and(o)}else{if(this._isOr(o)){return this._or(o)}}}}}},_isRaw:function(o){return o.operator==="_raw"},_raw:function(p){var o={};o[p.field]=p.value;return o},_isSimple:function(o){return typeof o.logic==="undefined"&&!this._isRegex(o)},_simple:function(r){var q={},o={};var p=this._translateoperator(r.operator);if(p){q[p]=r.value}else{q=r.value}o[r.field]=q;return o},_isRegex:function(o){return h.inArray(o.operator,m)!==-1},_regex:function(q){var o={};var r=this._getRegex(q);var p=this._getRegexValue(r);o[q.field]=p;return o},_getRegex:function(p){var q=p.value;var o=p.operator;switch(o){case"contains":return new RegExp(".*"+q+".*","i");case"startsWith":case"startswith":return new RegExp("^"+q,"i");case"endsWith":case"endswith":return new RegExp(q+"$","i")}throw new Error("Unknown operator type.")},_getRegexValue:function(o){return n.QueryBuilder.prototype._getRegexValue.call(this,o)},_isAnd:function(o){return o.logic==="and"},_and:function(t){var s,p,r,o={};var q=t.filters;for(s=0,p=q.length;s<p;s++){r=this._build(q[s]);o=this._andAppend(o,r)}return o},_andAppend:function(p,o){return n.QueryBuilder.prototype._andAppend.call(this,p,o)},_isOr:function(o){return o.logic==="or"},_or:function(t){var s,p,r,o=[];var q=t.filters;for(s=0,p=q.length;s<p;s++){r=this._build(q[s]);o.push(r)}return{$or:o}},_translateoperator:function(o){switch(o){case"eq":return null;case"neq":return"$ne";case"gt":return"$gt";case"lt":return"$lt";case"gte":return"$gte";case"lte":return"$lte"}throw new Error("Unknown operator type.")}};function b(o){return new n.Query(o.$where,null,o.$sort,o.$skip,o.$take)}var g=j.data.RemoteTransport.prototype.setup;j.data.RemoteTransport.prototype.setup=function(p,q){if(!p.url&&!this.options[q].url&&this.options.typeName){if(!n.$){throw new Error("You should either specify a url for this transport method, or instantiate an Everlive instance.")}p.url=n.Request.prototype.buildUrl(n.$.setup)+this.options.typeName;if(q==="update"||q==="destroy"){p.url+="/"+p.data[n.idField]}}if(n.$){p.headers=n.Request.prototype.buildAuthHeader(n.$.setup)}if(q==="read"&&p.data){var r=l(p.data);var o=b(r);p.headers=h.extend(p.headers,n.Request.prototype.buildQueryHeaders(o))}if(q==="create"||q==="read"||q==="update"){var s=p.success;p.success=function(t){n._traverseAndRevive(t);if(s){s(t)}}}return g.call(this,p,q)};var d=[n.idField,"CreatedAt"];var c=j.data.Model.prototype.accept;j.data.Model.prototype.accept=function(q){var o=this,r,p;n._traverseAndRevive(q);if(q&&o.isNew()&&q[n.idField]){for(r in o.fields){if(h.inArray(r,d)===-1){p=o.get(r);q[r]=p}}}else{if(q&&typeof q.ModifiedAt!=="undefined"){for(r in o.fields){if(r!=="ModifiedAt"){p=o.get(r);q[r]=p}}}}c.call(this,q)};var e=function(p,t){var r=f(t[t.length-1]);var q=t.slice(0,t.length-1);var s="/_expand";for(var o=0;o<q.length;o++){s+="/"+f(q[o])}return(function(v,u){return function(x){var w=p+"";if(x.Id&&u){w+=v+"/"+x.Id+"/"+u}return w}}(s,r))};var a=function(o){if(typeof o==="string"){return{}}else{return{"X-Everlive-Filter":JSON.stringify(o.filter),"X-Everlive-Sort":JSON.stringify(o.sort),"X-Everlive-Single-Field":o.singleField,"X-Everlive-Skip":o.skip,"X-Everlive-Take":o.take,"X-Everlive-Fields":JSON.stringify(o.fields)}}};var f=function(o){if(typeof o==="string"){return o}else{if(o.relation){return o.relation}else{throw new Error("You need to specify a 'relation' for an expand node when using the object notation")}}};n.createHierarchicalDataSource=function(p){p=p||{};var r=p.expand;var o=p.typeName;delete p.expand;delete p.typeName;var s;if(p.url){s=p.url}else{if(n.$&&o){s=n.Request.prototype.buildUrl(n.$.setup)+o}else{if(!n.$){throw new Error("You need to instantiate an Everlive instance in order to create a kendo HierarchicalDataSource.")}if(!o){throw new Error("You need to specify a 'typeName' in order to create a kendo HierarchicalDataSource.")}}}var u;if(r){for(var q=r.length-1;q>=0;q--){var u={model:{hasChildren:f(r[q]),children:{type:"everlive",transport:{read:{url:e(s,r.slice(0,q+1)),headers:a(r[q])}},schema:u}}}}}var t={};t.type="everlive";t.transport={typeName:o},t.schema=u;i(true,t,p);return new j.data.HierarchicalDataSource(t)};n.createDataSource=function(p){p=p||{};var o=p.typeName;if(!o){throw new Error("You need to specify a 'typeName' in order to create a kendo DataSource.")}delete p.typeName;var q={};q.type="everlive";q.transport={typeName:o},i(true,q,p);return new j.data.DataSource(q)}}));